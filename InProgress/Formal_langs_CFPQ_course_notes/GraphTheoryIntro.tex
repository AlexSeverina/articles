\section{Общие сведения теории графов}

В данном разделе мы дадим определения базовым понятиям из теории графов, рассмотрим несколько классических задач из области анализа графов и алгоритмы их решения.
Всё это понадобится нам при последующёй работе.

В дальнейшем нам будут нужны конечные ориентированные помеченные графы.
Мы будем использовать термин \textit{граф} подразумевая именно конечный ориентированный помеченный граф, если только не оговорено противное.

\begin{definition}
  \textit{Граф} $\mathcal{G} = \langle V, E, L \rangle$, где $V$ --- конечное множество вершин, $E$ --- конечное множество рёбер, $L$ --- конечное множество меток рёбер.
\end{definition}

Мы будем считать, что все вершины занумерованы подряд с нуля.
То есть можно считать, что $V$ --- это отрезок неотрицательный целых чисел.

\begin{example}
  Пример графа и его графического представления.
  Пусть граф $\mathcal{G}_1 = \langle \{0,1,2,3\}, \{(0,a,1), (1,a,2), (2,a,0), (2,b,3), (3,b,2)\}, \{a,b\} \rangle$.
  Графическое представление графа $\mathcal{G}_1$:
  \begin{center}
  %\begin{equation}\label{example:GraphG}
  \begin{tikzpicture}[shorten >=1pt,on grid,auto]
     \node[state] (q_0)   {$0$};
     \node[state] (q_1) [above right=of q_0] {$1$};
     \node[state] (q_2) [right=of q_0] {$2$};
     \node[state] (q_3) [right=of q_2] {$3$};
      \path[->]
      (q_0) edge  node {a} (q_1)
      (q_1) edge  node {a} (q_2)
      (q_2) edge  node {a} (q_0)
      (q_2) edge[bend left, above]  node {b} (q_3)
      (q_3) edge[bend left, below]  node {b} (q_2);
  \end{tikzpicture}
  %\end{equation}
  \end{center}
\end{example}

\begin{definition}
  \textit{Ребро} ориентированного помеченного графа $\mathcal{G} = \langle V, E, L \rangle$ это упорядоченная тройка из $V \times L \times V$.
\end{definition}

\begin{example}
$(0,a,1)$  и $(3,b,2)$ --- это рёбра графа $\mathcal{G}_1$.%\ref{example:GraphG}.
При этом, $(3,b,2)$ $(2,b,3)$ --- это разные рёбра, что видно из рисунка.
\end{example}

\begin{definition}
  \textit{Путём} $\pi$ в графе $\mathcal{G}$ будем называть последовательность рёбер такую, что для любых двух последовательных рёбер $e_1=(u_1,l_1,v_1)$ и $e_2=(u_2,l_2,v_2)$ в этой последовательности, конечная вершина первого ребра является начальной вершиной второго, то есть $v_1 = u_2$.
  Будем обобзначать путь из вершины $v_0$ в вершину $v_n$ как $v_0 \pi v_n = e_0,e_1, \dots, e_{n-1} = (v_0, l_0, v_1),(v_1,l_1,v_2),\dots,(v_{n-1},l_n,v_n)$.
\end{definition}


\begin{example}
$(0,a,1)(1,a,2) = 1\pi_1 2$  --- путь из вершины 0 в вершину 2 в графе $\mathcal{G}_1$.
При этом, $(0,a,1)(1,a,2)(2,b,3)(3,b,2) = 1\pi_2 2$ --- это тоже путь из вершины 0 в вершину 2 в графе $\mathcal{G}_1$, но он не равен $0\pi_1 2$.
\end{example}


Нам потребуется также отношение, отражающее факт существования пути между двумя вершинами.

\begin{definition}\label{def:reach}
  Отношение достижимости в графе $\mathcal{G} = \langle V, E, L \rangle$: $(v_i,v_j) \in P \iff \exists v_i \pi v_j$.
\end{definition}

Отметим, что рефлексивность этого отношения часто зависит от контекста.
В некоторых задачах по-умолчанию $(v_i,v_i) \notin P$, а чтобы это было верно, требуется явное наличие ребра-петли.

Один из способов задать граф --- это задать его \textit{матрицу смежности}.

\begin{definition}
  \textit{Матрица смежности} графа $\mathcal{G}=\langle V,E,L \rangle$ --- это квадратная матрица $M$ размера $n \times n$, где $|V| = n$ ячейки которой содержат множества.
  При этом $l \in M[i,j] \iff \exists e = (i,l,j) \in E$.
\end{definition}

Заметим, что наше определение матрицы смежности отличается от классического, в котором матрица отражает лишь факт наличия хотя бы одного ребра и, соответственно, является булевой.
То есть $M[i,j] = 1 \iff \exists e = (i,\_,j) \in E$.
Также можно встретить матрицы смежности в ячейках которых всё же хранится некоторая информация, однако, в единственном экземпляре.
То есть запрещены параллельные рёбра.
Такой подход часто можно встретить в задачах о кратчайших путях: в этом случае в ячейке хранится расстояние между двумя вершинами.

Мы ввели лишь общие понятия.
Специальные понятия, необходимые для иложения конкретного материала, будут даны в соответсвующих главах.


\subsection{Задачи поиска путей}

Одна из классических задач анализа графов --- это задача поиска путей между вершинами с различными ораничениями.

При этом, возможны различные постановки задачи.
С одной стороны, по тому, что именно мы хотим получить в качестве результата.
\begin{itemize}
\item Наличие пути, удовлетворяющего ограничениям, в графе.
\item Наличие пути, удовлетворяющего ограничениям, между некоторыми вершинами: задача достижимости. 
      Достижима ли вершина $v_1$ из вершины $v_2$ по пути, удовлетворяющему ограничениям.
      Такая постановка требует лишь проверить существование, но не обязательно предоставлять путь.
\item Поиск одного пути, удовлетворяющего ограничениям. Уже надо предъявлять путь.
\item Поиск всех путей. Надо предоставить все пути.
\end{itemize}

С другой тсороны, задачи различаются ещё и по тому, как фиксируем вершины.
\begin{itemize}
\item из одной вершины до всех
\item между всеми парами вершин
\item межу фиксированной парой вершин
\item Между двумя множествами вершин
\end{itemize}

Итого, можем сгенерировать прямое произведение различных постановок.

Ограничение, имеющее важное прикладное значение, --- минимальность длины. 
Иными словами, важная прикладная задача --- поиск кратчайших путей в графе.

Часто добавляют ограничения, что путь должен быть простым и другие.

Список интересных работ по APSP.

\subsection{Транзитивне замыкание графа}

Заметим, что отношение достижимости (\ref{def:reach}) является тринзитивным.
Действительно, если существует путь из $v_i$ в $v_j$ и путь из $v_j$ в $v_k$, то существует путь из $v_i$ в $v_k$.

\begin{definition}
  \textit{Транзитивным замыканием графа} называется транзитивное замыкание отношения достижимости по всему графу.
\end{definition}


Классическое решение: Флойд-Уоршал.

Матрицы.

Рассуждения про субкубичность.

Про то, что булево полукольцо.

Про APSP и произведение матриц.

\subsection{Вопросы и задачи}
\begin{enumerate}
  \item Реализуйте алгоритм построения транзитивного замыкания через матрицы.
  \item Реализовать матрицы самим.
  \item Взять готовую библиотеку матричных операций: CPU, GPGPU.
  \item Реализуйте поиск кратчайших путей через матричные операции.
  \item Взять готовую библиотеку матричных операций: CPU, GPGPU.
\end{enumerate}
