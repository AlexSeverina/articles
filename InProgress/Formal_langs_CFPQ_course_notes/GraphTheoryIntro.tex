\section{Общие сведения теории графов}

Дадим определения общим понятиям из теории графов.

В дальнейшем нам будут нужны конечные ориентированные помеченные графы.
Мы будем использовать термин \textit{граф} подразумевая именно конечный ориентированный помеченный граф, если только не оговорено противное.

\begin{definition}
  \textit{Граф} $\mathcal{G} = \langle V, E, L \rangle$, где $V$ --- конечное множество вершин, $E$ --- конечное множество рёбер, $L$ --- конечное множество меток рёбер.
\end{definition}

Мы будем считать, что все вершины занумерованы подряд с нуля.
То есть можно считать, что $V$ --- это отрезок неотрицательный целых чисел.

\begin{example}
  Пример графа и его графического представления.
  Пусть граф $\mathcal{G} = \langle \{0,1,2,3\}, \{(0,a,1), (1,a,2), (2,a,0), (2,b,3), (3,b,2)\}, \{a,b\} \rangle$.
  Графическое представление графа $\mathcal{G}$:
  \begin{center}
  \begin{tikzpicture}[shorten >=1pt,on grid,auto]
     \node[state] (q_0)   {$0$};
     \node[state] (q_1) [above right=of q_0] {$1$};
     \node[state] (q_2) [right=of q_0] {$2$};
     \node[state] (q_3) [right=of q_2] {$3$};
      \path[->]
      (q_0) edge  node {a} (q_1)
      (q_1) edge  node {a} (q_2)
      (q_2) edge  node {a} (q_0)
      (q_2) edge[bend left, above]  node {b} (q_3)
      (q_3) edge[bend left, below]  node {b} (q_2);
  \end{tikzpicture}
  \end{center}
\end{example}

\begin{definition}
  \textit{Ребро} ориентированного помеченного графа $\mathcal{G} = \langle V, E, L \rangle$ это упорядоченная тройка из $V \times L \times V$.
\end{definition}

\begin{definition}
  \textit{Путём} $\pi$ в графе $\mathcal{G}$ будем называть последовательность рёбер такую, что для любых двух последовательных рёбер $e_1=(u_1,l_1,v_1)$ и $e_2=(u_2,l_2,v_2)$ в этой последовательности, конечная вершина первого ребра является начальной вершиной второго, то есть $v_1 = u_2$.
  Будем обобзначать путь из вершины $v_0$ в вершину $v_n$ как $v_0 \pi v_n = e_0,e_1, \dots, e_{n-1} = (v_0, l_0, v_1),(v_1,l_1,v_2),\dots,(v_{n-1},l_n,v_n)$.
\end{definition}

Нам потребуется также отношение, отражающее факт существования пути между двумя вершинами.

\begin{definition}\label{def:reach}
  Отношение достижимости в графе $\mathcal{G} = \langle V, E, L \rangle$: $(v_i,v_j) \in P \iff \exists v_i \pi v_j$.
\end{definition}

Отметим, что рефлексивность этого отношения часто зависит от контекста.
В некоторых задачах по-умолчанию $(v_i,v_i) \notin P$, а чтобы это было верно, требуется явное наличие ребра-петли.

Один из способов задать граф --- это задать его \textit{матрицу смежности}.

\begin{definition}
  \textit{Матрица смежности} графа $\mathcal{G}=\langle V,E,L \rangle$ --- это квадратная матрица $M$ размера $n \times n$, где $|V| = n$ ячейки которой содержат множества.
  При этом $l \in M[i,j] \iff \exists e = (i,l,j) \in E$.
\end{definition}

Заметим, что наше определение матрицы смежности отличается от классического, в котором матрица отражает лишь факт наличия хотя бы одного ребра и, соответственно, является булевой.
То есть $M[i,j] = 1 \iff \exists e = (i,\_,j) \in E$.
Также можно встретить матрицы смежности в ячейках которых всё же хранится некоторая информация, однако, в единственном экземпляре.
То есть запрещены параллельные рёбра.
Такой подход часто можно встретить в задачах о кратчайших путях: в этом случае в ячейке хранится расстояние между двумя вершинами.

Мы ввели лишь общие понятия.
Специальные понятия, необходимые для иложения конкретного материала, будут даны в соответсвующих главах.

\subsection{Задачи поиска путей}

Одна из классических задач над графами --- искать пути с различными ораничениями.

Достижимость, все пути, один путь.

Про кратчайшие, простые и прочее.

Про классические задачи и классическое сведение к матричным операциям.

Тра-та-та.

Список интересных работ по APSP.

\subsection{Транзитивне замыкание графа}

Заметим, что отношение достижимости (\ref{def:reach}) является тринзитивным.
Действительно, если существует путь из $v_i$ в $v_j$ и путь из $v_j$ в $v_k$, то существует путь из $v_i$ в
$v_k$.

\begin{definition}
  \textit{Транзитивным замыканием графа} называется транзитивное замыкание отношения достижимости по всему графу.
\end{definition}


Флойд-Уоршалю

Матрицы.

Рассуждения про субкубичность.
Про то, что булево полукольцо.


\subsection{Вопросы и задачи}
\begin{enumerate}
  \item Реализуйте алгоритм построения транзитивного замыкания через матрицы.
  \item Реализовать матрицы самим.
  \item Взять готовую библиотеку матричных операций: CPU, GPGPU.
  \item Реализуйте поиск кратчайших путей через матричные операции.
  \item Взять готовую библиотеку матричных операций: CPU, GPGPU.
\end{enumerate}
