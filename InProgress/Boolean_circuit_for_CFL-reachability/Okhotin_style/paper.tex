%%%%%%%%%%%%%%%%%%%%%%% file template.tex %%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\RequirePackage{fix-cm}
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
\documentclass[smallextended]{svjour3}       % onecolumn (second format)
%\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
%
\usepackage{graphicx}
\usepackage[numbers]{natbib}
\usepackage{bussproofs}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[all,cmtip]{xy}
\usetikzlibrary{positioning, automata}
\usetikzlibrary{decorations.pathmorphing}

\tikzset{snake it/.style={decorate, decoration=snake}}

\usepackage[T1]{fontenc}
\DeclareFontFamily{T1}{calligra}{}
\DeclareFontShape{T1}{calligra}{m}{n}{<->s*[1.44]callig15}{}
\DeclareMathAlphabet\mathzapf       {T1}{pzc} {mb} {it}


%
% \usepackage{mathptmx}      % use Times fonts if available on your TeX system
%
% insert here the call for the packages your document requires
%\usepackage{latexsym}
% etc.
%
% please place your own definitions here and don't use \def but
% \newcommand{}{}
%
% Insert the name of "your journal" with
% \journalname{myjournal}
%
\begin{document}


\title{Parallel Complexity of CFL-Reachability Problem: Tractable Cases%\thanks{Grants or other notes
%about the article that should go on the front page should be
%placed here. General acknowledgments should be placed at the end of the article.}
}
%\subtitle{Do you have a subtitle?\\ If so, write it here}

%\titlerunning{Short form of title}        % if too long for running head

\author{Ekaterina Shemetova         \and
         Alexander Okhotin
         \and Semyon Grigorev %etc.
}

%\authorrunning{Short form of author list} % if too long for running head

\institute{E. Shemetova \at
             St. Petersburg Academic University, ul. Khlopina, 8, Saint Petersburg 194021, Russia, and \\ JetBrains Research \\
              \email{katyacyfra@gmail.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
           A. Okhotin \at
              St. Petersburg State University, 7/9 Universitetskaya nab., Saint Petersburg 199034, Russia, 
           \and
           S. Grigorev \at
              St. Petersburg State University, 7/9 Universitetskaya nab., Saint Petersburg 199034, Russia, 
and  JetBrains Research  \\
              \email{s.v.grigoriev@spbu.ru}    
}

\date{Received: date / Accepted: date}
% The correct dates will be entered by the editor


\maketitle

\begin{abstract}
Whereas it has been shown that  context-free language (CFL) reachability problem is P-complete, there are some subclasses of context-free languages, for which CFL-reachability lies in NC complexity class. We show two common classes which generalize known examples of such tractable subclasses: bounded-oscillation languages and context-free languages with a poly-slender storage languages. Polynomiality of the rational indices of languages in these classes is proved. Polynomial time algorithm for deciding whether a given PDA has poly-slender storage language is given. Closure properties of tractable subclasses in terms of polynomial rational index are investigated. 




\keywords{CFL-reachability \and parallel complexity \and graphs \and regular languages \and context-free languages \and context-free path queries}
% \PACS{PACS code1 \and PACS code2 \and more}
% \subclass{MSC code1 \and MSC code2 \and more}
\end{abstract}



\section{Introduction}
\label{intro}
The context-free language (CFL) reachability problem for a context-free grammar $G$ and directed edge-labelled graph $D$ consists of determining for pairs of nodes  $v$ and $u$ whether $v$ can reach $u$ via a path labelled by a string in $L(G)$. It is an important problem underlying some fundamential static code analysis like inter-procedural data flow analysis, inter-procedural slicing and other \cite*{Chatterjee, Incremental, RepsBasic}, and graph database query evaluation \cite*{Azimov, GrigorevRagozina, HellingsCFPQ, RDF}. CFL-reachability is a kind of graph reachability problem with path constraints given by context-free languages. Unlike context-free language recognition, which is in NC (when context-free grammar is fixed), CFL-reachability is P-complete \cite*{ RepSeq, Yannakakis}. Practically, it means that there is no efficient parallel algorithm for solving this problem (unless P $\neq$ NC). 


While problem is not parallelizable in general, it is useful to develop more efficient parallel solutions for a fixed classes of context-free languages. For example, there are context-free languages which admit more efficient parallel algorithms in comparision with the general case of context-free recognition \cite*{IBARRA, IBARRA2, Okhotin2014ComplexityOI}.  The same holds for CFL-reachability problem: there are some examples of context-free languages, for which CFL-reachability problem lies in NL complexity class (for example, linear and one-counter languages) \cite*{LabelledGraphs, LReach, Regularrealizability}. 


CFL-reachability problem has long been known to be P-complete \cite{PCompl}. A parallel complexity of this problem is studied by both static code analysis \cite*{RepSeq, RepsBasic} and database communities \cite*{ChainQ, Ullman, Yannakakis}. First investigations of such type were made in terms of Datalog queries, because Datalog query can be represented via context-free grammar, while database can be considered as a graph. Important decidability result is obtained in \cite{Vardi}: deciding whether a query is in NC or P-complete, is undecidable. Ulman and Van Gelder in \cite{Ullman} introduce a notion of a  \textit{polynomial fringe property} and shows that Datalog queries having this property are in NC. A query $\pi$ has the \textit{polynomial fringe property} if and only if there is a polynomial $p$ such that, for each regular language $R$ recognized by an automoton with $n$ states, $L(\pi) \cap R$ is either empty or contains a word shorter than $p(n)$. It is undecidable whether an elementary chain rule program has the polynomial fringe property. Their important results can be reinterpreted in terms of CFL-reachability as follows: 
\begin{enumerate}
\item CFL-reachability for linear languages and piecewise linear languages (each rule of the grammar has at most one recursive subgoal) and for arbitrary graphs is in NC, hence these languges have polynomial fringe property
\item The same holds for $D_1$ (the Dyck language on one kind of parentheses) and its GSM-mappings (one-counter languages)
\item CFL-reachability for $D_2$ (the Dyck language on two kinds of parentheses) is P-complete.
\end{enumerate}
Last result is important because any CFL can be represented as a $D_2$, so it is the direct consequence of P-competeness of CLF-reachability in general. Also, using the fact that $D_2$ is included in many interesting subclasses of context-free languages, such as visibly pushdown languages \cite{Okhotin2014ComplexityOI}, simply deterministic languages (which is LL(1)) we can state that CFL-reachability for these languages is P-complete. Afrati et al. in \cite{ChainQ} investigate parallel complexity of Datalog simple chain queries and presents Polynomial Stack Lemma which will be discussed in detail in Section~\ref{sec:poly}. 


The definition of polynomial fringe property coinsides with the notion of so called \textit{rational index}: for a context-free language having the polynomial rational index is the same as having polynomial fringe property. More precisely, rational index $\rho_L(n)$ is a function, which denotes maximum length of the shortest word in $L(\pi) \cap R$ for arbitrary $R$ recognized by $n$ state automaton. The notion of rational index was introduced in \cite{RatBasic} as a complexity measure for context-free languages and was investigated independently from the polynomial fringe property.  Particulary, it have been proved that the rational index of $D_1$ is in $O( n^2)$ \cite{Dyck1} and the rational index of languages generating all context-free languages (example of such language is $D_2$) belongs to $exp(\Theta(n^2/\ln n))$ \cite{CFRat}. An example of non-generating language with exponential rational index is given in \cite{Regularrealizability}. Also it have been shown that for every algebraic number $\gamma $ the language with the rational index in $\Theta (n^\gamma )$ exists \cite{GreibRat}. 


CFL-reachability problem can be observed as an intersection non-emptiness problem for context-free language (pushdown automaton) and regular language (finite automoton), because labelled graph is a special kind of nondeterministic finite automata. Complexity of such problem is studied in \cite*{ ganardi2016circuit, Intersection, VyalyiRR}.


For surveys investigating computational complexity of the language reachability for different variants of languages (regular, context-free, context-sensitive) and graphs (acyclic graphs, trees, grid graphs) we refer reader to \cite*{Barrett, LabelledGraphs, LReach}. 


\begin{figure}
\centering
\begin{tikzpicture}
\draw[fill=green, opacity=0.3](0,1) -- (0,0) -- (6,0) --  (6,1);
\draw(0,1) -- (0,0) -- (6,0) --  (6,1);
\draw(0,1) -- (6,1) -- (3, 7) -- (0,1) ;
%\draw[thick, dashed, rounded corners=5mm, fill=yellow, opacity=0.3] (0,1) -- (3.1, 1.5) -- (4.5, 3) -- (6,1);
\draw[thick, dashed, rounded corners=5mm, fill=red, opacity=0.3] (6,1) -- (2.9, 1.5) -- (1.5, 3) -- (0,1);
\draw[thick, densely dotted, rounded corners=5mm, fill=blue, opacity=0.2](0,1) -- (2.5, 5) -- (2.5,4)-- (2.8, 2) -- (6,1);
\draw[thick, densely dotted, rounded corners=5mm , fill=yellow, opacity=0.3](6,1) -- (3.5, 5) -- (3.5,4)-- (3.2, 2) -- (0,1);
\node (reg) at (3, 0.5) {Regular languages}; 
\node (cfl) at (3, 5.5) {CFL}; 
\node (lin) at (1.5, 1.9) {Linear}; 
\node (one) at (4.15, 2.4) {One-counter}; 
\node (linsc) at (2, 3) {Piecewise};
\node (linpsc) at (2.25, 2.7)  {linear}; 
\end{tikzpicture}
\caption{The hierarchy of languages, for which CFL-reachability problem is in NC .}
\label{hierarchy}      
\end{figure}
Our focus is on investigating the parallel complexity of CFL-reachability. Especially we are interested in generalization of ``easy'' subclasses and discovering new examples of context-free languages, for which CFL-reachability is in NC. Effective subclasses can be useful in practice, because general problem is not tractable \cite{ExperimentalCFPQ}. Also it is natural to ask which properties of such subclasses implies parallel effectiveness. A rational index and a fringe property are known as examples of such properties, but there is a lack of common characteristics in terms of pushdown automata for subclasses with the good rational index and fringe property. In other words, why some languages have polynomial rational indices? What is the difference between them and other subclasses of context free-languages?


Hierarchy of previously founded examples of context-free languages, for which CFL-reachability problem is in NC, is presented on Figure~\ref{hierarchy}. Linear (and piecewise linear) languages and one-counter languages form distinct families of context-free languages, but both have polynomial rational indices (polynomial fringe property).  Notice that one reason for this is that they are defined by natural restrictions on their pushdown automata (PDA). Restricting a PDA such that the height of its stack is only allowed to increase and then to decrease, thus performing only one turn, leads to the definition of one-turn PDAs. It is known that these PDAs can be characterized by linear grammars. One-counter languages are exactly languages recognized by PDA with only one stack symbol. But some of the restrictions on the pushdown store cannot be simulated by others and this is exactly the case of linear and one-counter languages. Our main idea to obtain generalizations of known tractable classes via investigation of restrictions on PDA store.

\textbf{Our contributions.} Our results can be summarized as follows:
\begin{itemize}
\item We show that CFL-reachability problem for bounded-oscillation languages, which were introduced in \cite{BoundOsc}, is in NC. This class generalizes the case of linear languages.
\item We introduce a new subclass of context-free languages --- context-free languages with a poly-slender pushdown store language. These languages are the natural generalization of one-counter languages and CFL-reachability problem for them is in NC. Decidability of deciding poly-slenderness of pushdown store language is proved and polynomial time algorithm are given. Also we obtain polynomial time algorithm for deciding where a given finite automaton recognize poly-slender rational language.  
\item Closure properties of the languages with polynomial rational indices are investigated, particulary it is shown that family of the languages with polynomial rational indices is a full AFL.
\end{itemize}


\textbf{Organization.} This paper is organized as follows. In Section \ref{sec:prel}, we present the basic definitions from formal languages used in this paper. In Section \ref{sec:osc} we study bounded-oscillation languages and show that CFL-reachability problem for them is in NC. In Section \ref{sec:poly} we introduce context-free languages with a poly-slender pushdown store language and investigate some of their properties. In Section \ref{sec:closure} our focus is on closure properties of the languages with polynomial rational indices. We conclude in Section \ref{sec:conc} with a summary of our findings.
\input{preliminaries.tex}
\input{boundedosc.tex}
\input{polystack.tex}
\input{closure.tex}
\section{Conclusions and open problems}
\label{sec:conc}
We have obtained two large classes for which CFL-reachability problem is in NC. The first is the class of bounded-oscillation languages, which generalizes linear languages. The second class is 
context-free languages with a poly-slender pushdown store languages, which is generalization of one-counter languages. Recall that regular languages have polynomial fringe property (and are accerted by PDA whith a bounded stack height), also It is known that L-reachibility for regular languages is in $NL \subseteq NC^2$ \cite*{LReach, Yannakakis}. Thereby it has been demonstrated that some natural restrictions on the pushdown storage implies polynomial rational index for corresponding context-free language: low variability of stack height during the PDA run (bounded-oscillation PDA) and low variety of stack contents (languages with a poly-slender pushdown store languages). 


It will be intersting to know is there another kind of stack restiction which implies polynomial rational index? Or is there a context-free language which does not belong to any mentioned class and is not obtained by applying language operation on them? Are there any other properties (except polynomial rational index) which implies parallel effectiveness of language? For example there is a Datalog query, which doesn't have a polynomial fringe property but its evaluation is in NC \cite{Kanellakis}. On the other hand, does any strict property of a context-free language, which means P-completeness of CFL-reachability for it exist? Of course, such property should be undecidable.


We considered CFL-reachability problem for a fixed context-free languages and arbitrary graphs. What tractable cases can be obtained for a fixed graphs and arbitrary context-free language? The known and trivial examples are acyclic graphs and trees. Can we have more complicated classes of graphs for which CFL-problem is in NC? Interesting algebraic properties of such graphs (NFA) are given in \cite{ganardi2016circuit}, but there is a lack of descriptions of these properties in terms of graphs (NFA). 


%\begin{acknowledgements}
%If you'd like to thank anyone, place your comments here
%and remove the percent signs.
%\end{acknowledgements}


% Authors must disclose all relationships or interests that 
% could have direct or potential influence or impart bias on 
% the work: 
%
% \section*{Conflict of interest}
%
% The authors declare that they have no conflict of interest.


% BibTeX users please use one of
%\bibliographystyle{spbasic}      % basic style, author-year citations
%\bibliographystyle{spmpsci}      % mathematics and physical sciences
%\bibliographystyle{spphys}       % APS-like style for physics
%\bibliography{}   % name your BibTeX data base

% Non-BibTeX users please use
%\begin{thebibliography}{}
%
% and use \bibitem to create references. Consult the Instructions
% for authors for reference list style.
%
%\bibitem{RefJ}
% Format for Journal Reference
%Author, Article title, Journal, Volume, page numbers (year)
% Format for books
%\bibitem{RefB}
%Author, Book title, page numbers. Publisher, place (year)
% etc
%\end{thebibliography}
\bibliographystyle{spbasic}      % basic style, author-year citations
\bibliography{paper}   % name your BibTeX data base
\end{document}
% end of file template.tex

