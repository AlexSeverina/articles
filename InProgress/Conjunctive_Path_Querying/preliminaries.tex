\section{Preliminaries} \label{section_preliminaries}
In this section, we introduce the basic notions used throughout the paper.

Let $\Sigma$ be a finite set of edge labels. Define an \textit{edge-labeled directed graph} as a tuple $D = (V, E)$ with a set of nodes $V$ and a directed edge-relation $E \subseteq V \times \Sigma \times V$.  For a path $\pi$ in a graph $D$, we denote the unique word obtained by concatenating the labels of the edges along the path $\pi$ as $l(\pi)$. Also, we write $n \pi m$ to indicate that a path $\pi$ starts at the node $n \in V$ and ends at the node $m \in V$.

We deviate from the usual definition of a conjunctive grammar in the \textit{binary normal form}~\cite{okhotinConjAndBool} by not including a special start non-terminal, which will be specified in the queries to the graph. Since every conjunctive grammar can be transformed into an equivalent one in the binary normal form~\cite{okhotinConjAndBool} and checking that an empty string is in the language is trivial, then it is sufficient to only consider grammars of the following type. A \textit{conjunctive grammar} is 3-tuple $G = (N, \Sigma, P)$ where $N$ is a finite set of non-terminals, $\Sigma$ is a finite set of terminals, and $P$ is a finite set of productions of the following forms:

\begin{itemize}
	\item $A \rightarrow B_1 C_1~\& \ldots \&~B_m C_m$, for $m \geq 1$, $A,B_i,C_i \in N$,
	\item $A \rightarrow x$, for $A \in N$ and $x \in \Sigma$.   
\end{itemize}

For conjunctive grammars, we use the conventional notation $A \xrightarrow{*} w$ to denote that the string $w \in \Sigma^*$ can be derived from a non-terminal $A$ by some sequence of applying the production rules from $P$. The relation $\rightarrow$ is defined as follows:
\begin{itemize}
	\item Using a rule $A \rightarrow B_1 C_1~\& \ldots \&~B_m C_m \in P$, any atomic subterm $A$ of any term can be rewritten by the subterm $(B_1 C_1 ~\& \ldots \&~ B_m C_m)$:
	\begin{center}
		$\ldots A \ldots \rightarrow \ldots (B_1 C_1~\& \ldots \&~B_m C_m) \ldots$
	\end{center}
	\item A conjunction of several identical strings in $\Sigma^*$ can be rewritten by one such string: for every $w \in \Sigma^*$,
	\begin{center}
		$\ldots (w~\& \ldots \&~w) \ldots \rightarrow \ldots w \ldots$
	\end{center}
	
\end{itemize}

The \textit{language} of a conjunctive grammar $G = (N,\Sigma,P)$ with respect to a start non-terminal $S \in N$ is defined by $L(G_S) = \{w \in \Sigma^*~|~S \xrightarrow{*} w\}$.

For a given graph $D = (V, E)$ and a conjunctive grammar $G = (N, \Sigma, P)$, we define \textit{conjunctive relations} $R_A \subseteq V \times V$, for every $A \in N$, such that $R_A = \{(n,m)~|~\exists n \pi m~(l(\pi) \in L(G_A))\}$. Note that this is similar to the definition of the context-free relations which is used for the context-free path querying~\cite{hellingsRelational}.

We define a \textit{conjunctive matrix multiplication}, $a \circ b = c$, where $a$ and $b$ are matrices of the suitable size that have subsets of $N$ as elements, as $c_{i,j} = \{A~|~\exists (A \rightarrow B_1 C_1~\& \ldots \&~B_m C_m) \in P \text{ such that } (B_k, C_k) \in d_{i,j} \}$, where $d_{i,j} = \bigcup^{n}_{k=1}{a_{i,k} \times b_{k,j}}$. 

Also, we define the \textit{conjunctive transitive closure} of a square matrix $a$ as $a^{conj} = a^{(1)} \cup a^{(2)} \cup \cdots$ where $a^{(i)} = a^{(i-1)} \cup (a^{(i-1)} \circ a^{(i-1)})$, $i \ge 2$ and $a^{(1)} = a$.
