\section{Context-free path querying by Kronecker product}


In this section, we introduce the algorithm for CFPQ which is based on Kronecker product of Boolean matrices. 
The algorithm provides the ability to solve all-pairs CFPQ in all-path semantics (according to Hellings~\cite{hellingsPathQuerying}) and consists of the two following parts. 
\begin{enumerate}
\item Index creation. In the first step, the algorithm computes an index which contains information which is necessary to restore paths for specified pairs of vertices. This index can be used to solve the reachability problem without paths extraction. Note that this index is finite even if the set of paths is infinite.
\item Paths extraction. All paths for the given pair of vertices can be enumerated by using the index computed at the previous step. As far as the set of paths can be infinite, all paths cannot be enumerated explicitly, and advanced techniques such as lazy evaluation are required for implementation. Anyway, a single path can by always extracted by using standard techniques.
\end{enumerate}

We describe both these steps, prove correctness, and provide time complexity estimations. 
For the first step we firstly introduce na{\"i}ve algortihm. After that we show how to achieve cubic time complexity by using dynamic transitive closure algorithm and demonstrate that this technique allow us to get truly subcubic CFPQ algortihm for planar graphs.

After that we provide step-by-step example of query evaluation by using the proposed algorithm.

\input{index_creation_algorithm}
\input{paths_extraction_algorithm}
\input{algorithm_example}