\section{Introduction}

Language-constrained path querying~\cite{doi:10.1137/S0097539798337716}, and particularly context-free path querying (CFPQ)~\cite{Yannakakis}, allows one to express path constraints for a graph in terms of context-free grammars: path in graph  included to query result only if concatenated labels along this path form a word belongs to the language, generated by query grammar. CFPQ is widely used in bioinformatics~\cite{GraphQueryWithEarley}, graph databases querying~\cite{hellings2015querying,Medeiros:2018:EEC:3167132.3167265,10.1145/3335783.3335791}, and RDF analysis~\cite{RDF}. 

CFPQ algorithms are actively developed, but still there is a problem with its performanve~\cite{10.1145/3335783.3335791}.
One of the most promising algorithms is the algorithm, proposed by Rustam Azimov~\cite{Azimov:2018:CPQ:3210259.3210264}. 
This algorithm allows one to offload computational intensive part to high-performance libraries for linear algebra, this way one can utilize modern parallel hardware for CFPQ.
But, as far as performance depends on grammar size, the number of grammar rules  is still a problem. To be handled by Azimov's algorithm, grammar should be converted to Chomsky Normal Form (CNF) which leads to the growth of rules number, consequently decreases performance. 

In this work, we propose a new algorithm for CFPQ which, first of all, can be expressed in terms of matrix operations. Thus our algorithm can be efficiently implemented on modern parallel hardware. Also, the proposed algorithm does not require grammar transformation.  Moreover, it provides ways for query optimizations.


Main contribution of this paper could be summarised as follows.

\begin{enumerate}
\item We introduce an new algorithm for CFPQ, which is based on recursive state machines intersection and can be expressed in terms of Kronecker product and transitive closure evaluation.
\item We provide a step-by-step example of the algorithm.
\item We provide an evaluation of the proposed algorithm and its comparison with matrix based algorithm. Evaluation results show that the idea is promising because we outperform matrix-based algorithm on the worst case data set, but optimizations are requred to be applicable for real-world cases.
\end{enumerate}

